(function(a){a.intelurate={core:{api:{lists:{},userGroup:{},versions:{}}},utilities:{}}})(jQuery);$.intelurate.core.api.query={QueryBuilder:"",OrderByBuilder:"",GroupByBuilder:"",CommandBuilder:"",Filter:"",Field:"",Operator:"",Value:"",Exist:false,Execute:function(){var a=this.OrderByBuilder+"<Where>"+this.QueryBuilder+"</Where>"+this.GroupByBuilder;this.Clear();return a},Clear:function(){this.OrderByBuilder="";this.QueryBuilder="";this.GroupByBuilder="";this.Exist=false;return this},Where:function(a){this.Filter="";this.Field=a;return this},And:function(a){this.Filter="And";this.Field=a;return this},Or:function(a){this.Filter="Or";this.Field=a;return this},Equal:function(a){this.Operator="Eq";this.Value=a;this.QueryBuilderFunc();return this},Eq:function(a){this.Operator="Eq";this.Value=a;this.QueryBuilderFunc();return this},NotEqual:function(a){this.Operator="Neq";this.Value=a;this.QueryBuilderFunc();return this},Neq:function(a){this.Operator="Neq";this.Value=a;this.QueryBuilderFunc();return this},GreaterThan:function(a){this.Operator="Gt";this.Value=a;this.QueryBuilderFunc();return this},Gt:function(a){this.Operator="Gt";this.Value=a;this.QueryBuilderFunc();return this},GreaterThanOrEqual:function(a){this.Operator="Geq";this.Value=a;this.QueryBuilderFunc();return this},Geq:function(a){this.Operator="Geq";this.Value=a;this.QueryBuilderFunc();return this},LessThan:function(a){this.Operator="Lt";this.Value=a;this.QueryBuilderFunc();return this},Lt:function(a){this.Operator="Lt";this.Value=a;this.QueryBuilderFunc();return this},LessThanOrEqual:function(a){this.Operator="Leq";this.Value=a;this.QueryBuilderFunc();return this},Leq:function(a){this.Operator="Leq";this.Value=a;this.QueryBuilderFunc();return this},IsNull:function(a){this.Operator="IsNull";this.Value=a;this.QueryBuilderFunc();return this},BeginsWith:function(a){this.Operator="BeginsWith";this.Value=a;this.QueryBuilderFunc();return this},Contains:function(a){this.Operator="Contains";this.Value=a;this.QueryBuilderFunc();return this},ContainsEach:function(a){var b=a.split(/ /g);var c=this;$.each(b,function(a,b){if(this.Filter==undefined){c.Operator="Contains";c.Value=b;c.QueryBuilderFunc();c.Filter="Or"}else{c.Operator="Contains";c.Value=b;c.QueryBuilderFunc()}});return this},OrderBy:function(a,b){var c="True";if(b=="Desc"){c="False"}var d="";d+="<OrderBy>";if(typeof a=="string"){d+='<FieldRef Name="'+a+'" Ascending="'+c+'" />'}else if(typeof a=="object"){$.each(a,function(a,b){d+='<FieldRef Name="'+b+'" Ascending="'+c+'" />'})}d+="</OrderBy>";this.OrderByBuilder=d;if(this.OrderByBuilder!=""){this.Exist=true}return this},GroupBy:function(a,b){var c="True";if(b=="Desc"){c="False"}var d="";d+='<GroupBy Collapse="FALSE">';if(typeof a=="string"){d+='<FieldRef Name="'+a+'" Ascending="'+c+'" />'}else if(typeof a=="object"){$.each(a,function(a,b){d+='<FieldRef Name="'+b+'" Ascending="'+c+'" />'})}d+="</GroupBy>";this.GroupByBuilder=d;if(this.GroupByBuilder!=""){this.Exist=true}return this},QueryBuilderFunc:function(){this.CommandBuilder="";if(this.Filter!=""){this.CommandBuilder+="<"+this.Filter+">";this.CommandBuilder+=this.QueryBuilder;this.CommandBuilder+="<"+this.Operator+'><FieldRef Name="'+this.Field+'" /><Value Type="Text">'+this.Value+"</Value></"+this.Operator+">";this.CommandBuilder+="</"+this.Filter+">";this.QueryBuilder=this.CommandBuilder}else{this.CommandBuilder+="<"+this.Operator+'><FieldRef Name="'+this.Field+'" /><Value Type="Text">'+this.Value+"</Value></"+this.Operator+">";this.QueryBuilder=this.CommandBuilder}if(this.QueryBuilder!=""){this.Exist=true}return this}};$.intelurate.core.api.lists.getListItems=function(a){function l(a){try{$.parseJSON(a)}catch(b){return false}return true}function m(){$.ajax({url:c.webSite+"_vti_bin/Lists.asmx",beforeSend:function(a){a.setRequestHeader("SOAPAction","http://schemas.microsoft.com/sharepoint/soap/GetListItems")},type:"POST",dataType:"xml",data:f,complete:function(a){var b=$(a.responseXML).find("rs\\:data, data").attr("ListItemCollectionPositionNext");c.next=b;if(c.printXml==true){console.log(a.responseXML.xml)}var d={Rows:[]};$(a.responseXML).find("z\\:row, row").each(function(a,b){var f=a;d.Rows[a]={};xmlObj=$(this);var g="";$.each(c.fields,function(a,b){var g="";var h="";if(xmlObj.attr(e[a])!=undefined){if(xmlObj.attr(e[a]).search("#")>-1){g=xmlObj.attr(e[a]).split("#");$.each(g,function(a,b){if(a>0){h+=b}})}else{h=xmlObj.attr(e[a])}}else{h="NoData"}if(c.mapping!=null){$.each(c.mapping,function(a,c){var d=c.split("=");if(b==d[1]){b=d[0]}})}if(l(h)){d.Rows[f][b]=h}else{if(c.richText==true){d.Rows[f][b]=$.intelurate.utilities.charConverter.richText(h)}else{d.Rows[f][b]=$.intelurate.utilities.charConverter.displayHTML(h)}}})});if(c.cache){if(i==true){sessvars.Cache.push({cacheID:MD5(f),cachedJSON:d})}}c.complete(d)},contentType:'text/xml; charset="utf-8"'})}var b={webSite:null,listName:null,fields:null,mapping:null,query:null,folderPath:null,scope:null,rowLimit:100,complete:function(a){},next:null,printXml:false,cache:false,cacheTime:6e4};var a=$.extend(b,a);var c=a;if(c.webSite==null){c.webSite=L_Menu_BaseUrl+"/"}var d="";var e=new Array;$.each(c.fields,function(a,b){d+="<FieldRef Name='"+b.replace(/\s/g,"_x0020_")+"' />";e[a]="ows_"+b.replace(/\s/g,"_x0020_")});var f="";f+="<soapenv:Envelope xmlns:soapenv='http://schemas.xmlsoap.org/soap/envelope/'>"+"<soapenv:Body>"+"<GetListItems xmlns='http://schemas.microsoft.com/sharepoint/soap/'>"+"<listName>"+c.listName+"</listName>";f+="<query><Query>";if(c.query!=null){f+=c.query}f+="</Query></query>";f+="<viewFields><ViewFields>";f+=d;f+="</ViewFields></viewFields>";f+="<rowLimit>"+c.rowLimit+"</rowLimit>";var g="";if(c.folderPath!=null){g="<Folder>"+window.location.protocol+"//"+document.domain+c.webSite+c.folderPath+"</Folder>"}var h="";if(c.scope=="Default"){h="<ViewAttributes Scope='Default' />"}else if(c.scope=="Recursive"){h="<ViewAttributes Scope='Recursive' />"}else if(c.scope=="RecursiveAll"){h="<ViewAttributes Scope='RecursiveAll' />"}else if(c.scope=="FilesOnly"){h="<ViewAttributes Scope='FilesOnly' />"}f+="<queryOptions><QueryOptions>";f+=h;f+=g;if(c.next!=null){c.next=c.next.replace(/&/g,"&");f+='<Paging ListItemCollectionPositionNext="'+c.next+'" />'}f+="</QueryOptions></queryOptions>";f+="</GetListItems>"+"</soapenv:Body>"+"</soapenv:Envelope>";var i=true;if(c.cache){var j=new Date;var k=j.getTime();if(typeof sessvars!="undefined"){if(k>sessvars.Timer+c.cacheTime){sessvars.$.clearMem()}if(typeof sessvars.Cache=="undefined"){sessvars.Cache=[];sessvars.Timer=k}$.each(sessvars.Cache,function(a,b){if(b.cacheID==MD5(f)){i=false;c.complete(b.cachedJSON);return false}});if(i==true){m()}}else{alert("session vars not installed")}}else{m()}};$.intelurate.core.api.lists.newListItems=function(a){var b={webSite:null,listName:null,newItems:null,fields:null,richText:false,printXml:false,complete:function(a){}};var a=$.extend(b,a);var c=a;var d="";if(c.webSite==null){c.webSite=L_Menu_BaseUrl+"/"}if(c.newItems!=null){$.each(c.newItems,function(a,b){d+='<Method ID="'+a+'" Cmd="New">';$.each(b.item,function(a,b){d+='<Field Name="'+b[0]+'">'+$.intelurate.utilities.charConverter.convertTagsToCodes(b[1])+"</Field>"});d+="</Method>"});if(c.fields!=null){var e=new Array;$.each(c.fields,function(a,b){e[a]="ows_"+b.replace(/\s/g,"_x0020_")})}function f(a){try{$.parseJSON(a)}catch(b){return false}return true}var g='<?xml version="1.0" encoding="utf-8"?>'+"<soap:Envelope xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xmlns:xsd='http://www.w3.org/2001/XMLSchema' xmlns:soap='http://schemas.xmlsoap.org/soap/envelope/'>"+"<soap:Body>"+"<UpdateListItems xmlns='http://schemas.microsoft.com/sharepoint/soap/'>"+"<listName>"+c.listName+"</listName>"+"<updates>"+"<Batch OnError='Continue' >";g+=d;g+="</Batch>"+"</updates>"+"</UpdateListItems>"+"</soap:Body>"+"</soap:Envelope>";$.ajax({url:c.webSite+"_vti_bin/Lists.asmx",beforeSend:function(a){a.setRequestHeader("SOAPAction","http://schemas.microsoft.com/sharepoint/soap/UpdateListItems")},type:"POST",dataType:"xml",data:g,complete:function(a){if(c.printXml==true){console.log(a.responseXML.xml)}var b={Rows:[]};if(c.fields!=null){$(a.responseXML).find("z\\:row, row").each(function(a,d){var g=a;b.Rows[a]={};xmlObj=$(this);var h="";$.each(c.fields,function(a,d){var h="";var i="";if(xmlObj.attr(e[a])!=undefined){if(xmlObj.attr(e[a]).search("#")>-1){h=xmlObj.attr(e[a]).split("#");$.each(h,function(a,b){if(a>0){i+=b}})}else{i=xmlObj.attr(e[a])}}else{i="NoData"}if(c.mapping!=null){$.each(c.mapping,function(a,b){var c=b.split("=");if(d==c[1]){d=c[0]}})}if(f(i)){b.Rows[g][d]=i}else{if(c.richText==true){b.Rows[g][d]=$.intelurate.utilities.charConverter.richText(i)}else{b.Rows[g][d]=$.intelurate.utilities.charConverter.displayHTML(i)}}})})}else{b="no return values"}c.complete(b)},contentType:'text/xml; charset="utf-8"'})}else{alert("Your update list items has no commands associated with it")}};$.intelurate.core.api.lists.updateListItems=function(a){var b={webSite:null,listName:null,updateItems:null,fields:null,richText:false,printXml:false,complete:function(a){}};var a=$.extend(b,a);var c=a;var d="";if(c.webSite==null){c.webSite=L_Menu_BaseUrl+"/"}if(c.updateItems!=null){$.each(c.updateItems,function(a,b){d+='<Method ID="'+a+'" Cmd="Update">';d+='<Field Name="ID">'+b.item[0]+"</Field>";$.each(b.item,function(a,b){if(a>0){d+='<Field Name="'+b[0]+'">'+$.intelurate.utilities.charConverter.convertTagsToCodes(b[1])+"</Field>"}});d+="</Method>"});if(c.fields!=null){var e=new Array;$.each(c.fields,function(a,b){e[a]="ows_"+b.replace(/\s/g,"_x0020_")})}function f(a){try{$.parseJSON(a)}catch(b){return false}return true}var g='<?xml version="1.0" encoding="utf-8"?>'+"<soap:Envelope xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xmlns:xsd='http://www.w3.org/2001/XMLSchema' xmlns:soap='http://schemas.xmlsoap.org/soap/envelope/'>"+"<soap:Body>"+"<UpdateListItems xmlns='http://schemas.microsoft.com/sharepoint/soap/'>"+"<listName>"+c.listName+"</listName>"+"<updates>"+"<Batch OnError='Continue' >";g+=d;g+="</Batch>"+"</updates>"+"</UpdateListItems>"+"</soap:Body>"+"</soap:Envelope>";$.ajax({url:c.webSite+"_vti_bin/Lists.asmx",beforeSend:function(a){a.setRequestHeader("SOAPAction","http://schemas.microsoft.com/sharepoint/soap/UpdateListItems")},type:"POST",dataType:"xml",data:g,complete:function(a){if(c.printXml==true){console.log(a.responseXML.xml)}var b={Rows:[]};if(c.fields!=null){$(a.responseXML).find("z\\:row, row").each(function(a,d){var g=a;b.Rows[a]={};xmlObj=$(this);var h="";$.each(c.fields,function(a,d){var h="";var i="";if(xmlObj.attr(e[a])!=undefined){if(xmlObj.attr(e[a]).search("#")>-1){h=xmlObj.attr(e[a]).split("#");$.each(h,function(a,b){if(a>0){i+=b}})}else{i=xmlObj.attr(e[a])}}else{i="NoData"}if(c.mapping!=null){$.each(c.mapping,function(a,b){var c=b.split("=");if(d==c[1]){d=c[0]}})}if(f(i)){b.Rows[g][d]=i}else{if(c.richText==true){b.Rows[g][d]=$.intelurate.utilities.charConverter.richText(i)}else{b.Rows[g][d]=$.intelurate.utilities.charConverter.displayHTML(i)}}})})}else{b="no return values"}c.complete(b)},contentType:'text/xml; charset="utf-8"'})}else{alert("Your new list items has no commands associated with it")}};$.intelurate.core.api.lists.deleteListItems=function(a){var b={webSite:null,listName:null,deleteItems:null,printXml:false,complete:function(a){}};var a=$.extend(b,a);var c=a;var d="";if(c.webSite==null){c.webSite=L_Menu_BaseUrl+"/"}if(c.deleteItems!=null){$.each(c.deleteItems,function(a,b){d+='<Method ID="'+a+'" Cmd="Delete">';d+='<Field Name="ID">'+b.item+"</Field>";d+="</Method>"});var e='<?xml version="1.0" encoding="utf-8"?>'+"<soap:Envelope xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xmlns:xsd='http://www.w3.org/2001/XMLSchema' xmlns:soap='http://schemas.xmlsoap.org/soap/envelope/'>"+"<soap:Body>"+"<UpdateListItems xmlns='http://schemas.microsoft.com/sharepoint/soap/'>"+"<listName>"+c.listName+"</listName>"+"<updates>"+"<Batch OnError='Continue' >";e+=d;e+="</Batch>"+"</updates>"+"</UpdateListItems>"+"</soap:Body>"+"</soap:Envelope>";$.ajax({url:c.webSite+"_vti_bin/Lists.asmx",beforeSend:function(a){a.setRequestHeader("SOAPAction","http://schemas.microsoft.com/sharepoint/soap/UpdateListItems")},type:"POST",dataType:"xml",data:e,complete:function(a){if(c.printXml==true){console.log(a.responseXML.xml)}var b={Rows:[]};$(a.responseXML).find("Result").each(function(a,c){var d=$(this).attr("ID").split(",")[0];b.Rows[a]={deletedItem:d}});c.complete(b)},contentType:'text/xml; charset="utf-8"'})}else{alert("Your delete has no commands associated with it")}};$.intelurate.core.api.lists.getItemAttachments=function(a){var b={SPWebSite:null,ListName:null,ItemID:null,Complete:function(a){}};var a=$.extend(b,a);var c=a;var d='<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">		<soap:Body>			<GetAttachmentCollection xmlns="http://schemas.microsoft.com/sharepoint/soap/">				<listName>'+c.ListName+"</listName>				<listItemID>"+c.ItemID+"</listItemID>			</GetAttachmentCollection>		</soap:Body>	</soap:Envelope>";$.ajax({url:c.SPWebSite+"_vti_bin/Lists.asmx",beforeSend:function(a){a.setRequestHeader("SOAPAction","http://schemas.microsoft.com/sharepoint/soap/GetAttachmentCollection")},type:"POST",dataType:"xml",data:d,complete:function(a){var b={Attachment:[]};$(a.responseXML).find("Attachment").each(function(a,c){if($(c).text()!=undefined){b.Attachment[a]=$(c).text()}});c.Complete(b)},contentType:'text/xml; charset="utf-8"'})};$.intelurate.core.api.lists.getListCollection=function(a){var b={webSite:null,complete:function(a){}};var a=$.extend(b,a);var c=a;if(c.webSite==null){c.webSite=L_Menu_BaseUrl+"/"}var d='<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">					  <soap:Body>						<GetListCollection xmlns="http://schemas.microsoft.com/sharepoint/soap/" />					  </soap:Body>					</soap:Envelope>';$.ajax({url:c.webSite+"_vti_bin/Lists.asmx",beforeSend:function(a){a.setRequestHeader("SOAPAction","http://schemas.microsoft.com/sharepoint/soap/GetListCollection")},type:"POST",dataType:"xml",data:d,complete:function(a){console.log(a.responseXML.xml)},contentType:'text/xml; charset="utf-8"'})};$.intelurate.core.api.userGroup.getCurrentUserInfo=function(a){var b={webSite:null,complete:function(a){}};var a=$.extend(b,a);var c=a;if(c.webSite==null){c.webSite=L_Menu_BaseUrl+"/"}var d='<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">					  <soap:Body>						<GetCurrentUserInfo xmlns="http://schemas.microsoft.com/sharepoint/soap/directory/" />					  </soap:Body>					</soap:Envelope>';$.ajax({url:c.webSite+"_vti_bin/UserGroup.asmx",beforeSend:function(a){a.setRequestHeader("SOAPAction","http://schemas.microsoft.com/sharepoint/soap/directory/GetCurrentUserInfo")},type:"POST",dataType:"xml",data:d,complete:function(a){var b={UserInfo:{ID:$(a.responseXML).find("User").attr("ID"),Sid:$(a.responseXML).find("User").attr("Sid"),Name:$(a.responseXML).find("User").attr("Name"),LoginName:$(a.responseXML).find("User").attr("LoginName"),Email:$(a.responseXML).find("User").attr("Email"),Notes:$(a.responseXML).find("User").attr("Notes"),IsSiteAdmin:$(a.responseXML).find("User").attr("IsSiteAdmin"),IsDomainGroup:$(a.responseXML).find("User").attr("IsDomainGroup"),Flags:$(a.responseXML).find("User").attr("Flags")}};c.complete(b)},contentType:'text/xml; charset="utf-8"'})};$.intelurate.core.api.userGroup.getUserCollectionFromSite=function(a){var b={webSite:null,complete:function(a){}};var a=$.extend(b,a);var c=a;var d='<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">				  <soap:Body>					<GetUserCollectionFromSite xmlns="http://schemas.microsoft.com/sharepoint/soap/directory/" />				  </soap:Body>				</soap:Envelope>';$.ajax({url:c.webSite+"_vti_bin/UserGroup.asmx",beforeSend:function(a){a.setRequestHeader("SOAPAction","http://schemas.microsoft.com/sharepoint/soap/directory/GetUserCollectionFromSite")},type:"POST",dataType:"xml",data:d,complete:function(a){var b={Users:[]};$(a.responseXML).find("User").each(function(a,b){console.log("Name: "+$(b).attr("Name")+" Email: "+$(b).attr("Email")+" LoginName: "+$(b).attr("LoginName"))});c.complete(attachmentJsonObj)},contentType:'text/xml; charset="utf-8"'})};$.intelurate.core.api.userGroup.getUserCollectionFromWeb=function(a){var b={webSite:null,complete:function(a){}};var a=$.extend(b,a);var c=a;if(c.webSite==null){c.webSite=L_Menu_BaseUrl+"/"}var d='<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">					  <soap:Body>						<GetUserCollectionFromWeb xmlns="http://schemas.microsoft.com/sharepoint/soap/directory/" />					  </soap:Body>					</soap:Envelope>';$.ajax({url:c.webSite+"_vti_bin/UserGroup.asmx",beforeSend:function(a){a.setRequestHeader("SOAPAction","http://schemas.microsoft.com/sharepoint/soap/directory/SPServiceGetUserCollectionFromWeb")},type:"POST",dataType:"xml",data:d,complete:function(a){var b={Users:[]};$(a.responseXML).find("User").each(function(a,b){console.log("Name: "+$(b).attr("Name")+" Email: "+$(b).attr("Email")+" LoginName: "+$(b).attr("LoginName"))});c.complete(attachmentJsonObj)},contentType:'text/xml; charset="utf-8"'})};$.intelurate.core.api.lists.getListCollection=function(a){var b={webSite:null,complete:function(a){}};var a=$.extend(b,a);var c=a;if(c.webSite==null){c.webSite=L_Menu_BaseUrl+"/"}var d='<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">					<soap:Body>						<GetListCollection xmlns="http://schemas.microsoft.com/sharepoint/soap/" />					</soap:Body>				   </soap:Envelope>';$.ajax({url:c.webSite+"_vti_bin/Lists.asmx",beforeSend:function(a){a.setRequestHeader("SOAPAction","http://schemas.microsoft.com/sharepoint/soap/GetListCollection")},type:"POST",dataType:"xml",data:d,complete:function(a){var b={List:[]};$(a.responseXML).find("List").each(function(a,c){b.List[a]={};b.List[a].DocTemplateUrl=$(c).attr("DocTemplateUrl");b.List[a].DefaultViewUrl=$(c).attr("DefaultViewUrl");b.List[a].MobileDefaultViewUrl=$(c).attr("MobileDefaultViewUrl");b.List[a].ID=$(c).attr("ID");b.List[a].Title=$(c).attr("Title");b.List[a].Description=$(c).attr("Description");b.List[a].ImageUrl=$(c).attr("ImageUrl");b.List[a].Name=$(c).attr("Name");b.List[a].BaseType=$(c).attr("BaseType");b.List[a].FeatureId=$(c).attr("FeatureId");b.List[a].ServerTemplate=$(c).attr("ServerTemplate");b.List[a].Created=$(c).attr("Created");b.List[a].Modified=$(c).attr("Modified");b.List[a].LastDeleted=$(c).attr("LastDeleted");b.List[a].Version=$(c).attr("Version");b.List[a].Direction=$(c).attr("Direction");b.List[a].ThumbnailSize=$(c).attr("ThumbnailSize");b.List[a].WebImageWidth=$(c).attr("WebImageWidth");b.List[a].WebImageHeight=$(c).attr("WebImageHeight");b.List[a].Flags=$(c).attr("Flags");b.List[a].ItemCount=$(c).attr("ItemCount");b.List[a].AnonymousPermMask=$(c).attr("AnonymousPermMask");b.List[a].RootFolder=$(c).attr("RootFolder");b.List[a].ReadSecurity=$(c).attr("ReadSecurity");b.List[a].WriteSecurity=$(c).attr("WriteSecurity");b.List[a].Author=$(c).attr("Author");b.List[a].EventSinkAssembly=$(c).attr("EventSinkAssembly");b.List[a].EventSinkClass=$(c).attr("EventSinkClass");b.List[a].EventSinkData=$(c).attr("EventSinkData");b.List[a].EmailAlias=$(c).attr("EmailAlias");b.List[a].WebFullUrl=$(c).attr("WebFullUrl");b.List[a].WebId=$(c).attr("WebId");b.List[a].SendToLocation=$(c).attr("SendToLocation");b.List[a].ScopeId=$(c).attr("ScopeId");b.List[a].MajorVersionLimit=$(c).attr("MajorVersionLimit");b.List[a].MajorWithMinorVersionsLimit=$(c).attr("MajorWithMinorVersionsLimit");b.List[a].WorkFlowId=$(c).attr("WorkFlowId");b.List[a].HasUniqueScopes=$(c).attr("HasUniqueScopes");b.List[a].NoThrottleListOperations=$(c).attr("NoThrottleListOperations");b.List[a].HasRelatedLists=$(c).attr("HasRelatedLists");b.List[a].AllowDeletion=$(c).attr("AllowDeletion");b.List[a].AllowMultiResponses=$(c).attr("AllowMultiResponses");b.List[a].EnableAttachments=$(c).attr("EnableAttachments");b.List[a].EnableModeration=$(c).attr("EnableModeration");b.List[a].EnableVersioning=$(c).attr("EnableVersioning");b.List[a].HasExternalDataSource=$(c).attr("HasExternalDataSource");b.List[a].Hidden=$(c).attr("Hidden");b.List[a].MultipleDataList=$(c).attr("MultipleDataList");b.List[a].Ordered=$(c).attr("Ordered");b.List[a].ShowUser=$(c).attr("ShowUser");b.List[a].EnablePeopleSelector=$(c).attr("EnablePeopleSelector");b.List[a].EnableResourceSelector=$(c).attr("EnableResourceSelector");b.List[a].EnableMinorVersion=$(c).attr("EnableMinorVersion");b.List[a].RequireCheckout=$(c).attr("RequireCheckout");b.List[a].ThrottleListOperations=$(c).attr("ThrottleListOperations");b.List[a].ExcludeFromOfflineClient=$(c).attr("ExcludeFromOfflineClient");b.List[a].EnableFolderCreation=$(c).attr("EnableFolderCreation");b.List[a].IrmEnabled=$(c).attr("IrmEnabled");b.List[a].IsApplicationList=$(c).attr("IsApplicationList");b.List[a].PreserveEmptyValues=$(c).attr("PreserveEmptyValues");b.List[a].StrictTypeCoercion=$(c).attr("StrictTypeCoercion");b.List[a].EnforceDataValidation=$(c).attr("EnforceDataValidation");b.List[a].MaxItemsPerThrottledOperation=$(c).attr("MaxItemsPerThrottledOperation")});c.complete(b)},contentType:'text/xml; charset="utf-8"'})};$.intelurate.core.api.lists.getList=function(a){var b={webSite:null,listName:null,complete:function(a){}};var a=$.extend(b,a);var c=a;if(c.webSite==null){c.webSite=L_Menu_BaseUrl+"/"}var d='<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">					  <soap:Body>						<GetList xmlns="http://schemas.microsoft.com/sharepoint/soap/">						  <listName>'+c.listName+"</listName>						</GetList>					  </soap:Body>					</soap:Envelope>";$.ajax({url:c.webSite+"_vti_bin/Lists.asmx",beforeSend:function(a){a.setRequestHeader("SOAPAction","http://schemas.microsoft.com/sharepoint/soap/GetList")},type:"POST",dataType:"xml",data:d,complete:function(a){console.log(a.responseXML.xml);var b={List:{}};var d=$(a.responseXML).find("List");b.List.DocTemplateUrl=$(d).attr("DocTemplateUrl");b.List.DefaultViewUrl=$(d).attr("DefaultViewUrl");b.List.MobileDefaultViewUrl=$(d).attr("MobileDefaultViewUrl");b.List.ID=$(d).attr("ID");b.List.Title=$(d).attr("Title");b.List.Description=$(d).attr("Description");b.List.ImageUrl=$(d).attr("ImageUrl");b.List.Name=$(d).attr("Name");b.List.BaseType=$(d).attr("BaseType");b.List.FeatureId=$(d).attr("FeatureId");b.List.ServerTemplate=$(d).attr("ServerTemplate");b.List.Created=$(d).attr("Created");b.List.Modified=$(d).attr("Modified");b.List.LastDeleted=$(d).attr("LastDeleted");b.List.Version=$(d).attr("Version");b.List.Direction=$(d).attr("Direction");b.List.ThumbnailSize=$(d).attr("ThumbnailSize");b.List.WebImageWidth=$(d).attr("WebImageWidth");b.List.WebImageHeight=$(d).attr("WebImageHeight");b.List.Flags=$(d).attr("Flags");b.List.ItemCount=$(d).attr("ItemCount");b.List.AnonymousPermMask=$(d).attr("AnonymousPermMask");b.List.RootFolder=$(d).attr("RootFolder");b.List.ReadSecurity=$(d).attr("ReadSecurity");b.List.WriteSecurity=$(d).attr("WriteSecurity");b.List.Author=$(d).attr("Author");b.List.EventSinkAssembly=$(d).attr("EventSinkAssembly");b.List.EventSinkClass=$(d).attr("EventSinkClass");b.List.EventSinkData=$(d).attr("EventSinkData");b.List.EmailAlias=$(d).attr("EmailAlias");b.List.WebFullUrl=$(d).attr("WebFullUrl");b.List.WebId=$(d).attr("WebId");b.List.SendToLocation=$(d).attr("SendToLocation");b.List.ScopeId=$(d).attr("ScopeId");b.List.MajorVersionLimit=$(d).attr("MajorVersionLimit");b.List.MajorWithMinorVersionsLimit=$(d).attr("MajorWithMinorVersionsLimit");b.List.WorkFlowId=$(d).attr("WorkFlowId");b.List.HasUniqueScopes=$(d).attr("HasUniqueScopes");b.List.NoThrottleListOperations=$(d).attr("NoThrottleListOperations");b.List.HasRelatedLists=$(d).attr("HasRelatedLists");b.List.AllowDeletion=$(d).attr("AllowDeletion");b.List.AllowMultiResponses=$(d).attr("AllowMultiResponses");b.List.EnableAttachments=$(d).attr("EnableAttachments");b.List.EnableModeration=$(d).attr("EnableModeration");b.List.EnableVersioning=$(d).attr("EnableVersioning");b.List.HasExternalDataSource=$(d).attr("HasExternalDataSource");b.List.Hidden=$(d).attr("Hidden");b.List.MultipleDataList=$(d).attr("MultipleDataList");b.List.Ordered=$(d).attr("Ordered");b.List.ShowUser=$(d).attr("ShowUser");b.List.EnablePeopleSelector=$(d).attr("EnablePeopleSelector");b.List.EnableResourceSelector=$(d).attr("EnableResourceSelector");b.List.EnableMinorVersion=$(d).attr("EnableMinorVersion");b.List.RequireCheckout=$(d).attr("RequireCheckout");b.List.ThrottleListOperations=$(d).attr("ThrottleListOperations");b.List.ExcludeFromOfflineClient=$(d).attr("ExcludeFromOfflineClient");b.List.EnableFolderCreation=$(d).attr("EnableFolderCreation");b.List.IrmEnabled=$(d).attr("IrmEnabled");b.List.IsApplicationList=$(d).attr("IsApplicationList");b.List.PreserveEmptyValues=$(d).attr("PreserveEmptyValues");b.List.StrictTypeCoercion=$(d).attr("StrictTypeCoercion");b.List.EnforceDataValidation=$(d).attr("EnforceDataValidation");b.List.MaxItemsPerThrottledOperation=$(d).attr("MaxItemsPerThrottledOperation");c.complete(b)},contentType:'text/xml; charset="utf-8"'})};$.intelurate.core.api.lists.checkInFile=function(a){var b={webSite:null,url:null,comment:null,checkinType:0,complete:function(a){}};var a=$.extend(b,a);var c=a;if(c.webSite==null){c.webSite=L_Menu_BaseUrl+"/"}var d='<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">					  <soap:Body>						<CheckInFile xmlns="http://schemas.microsoft.com/sharepoint/soap/">						  <pageUrl>'+c.url+"</pageUrl>						  <comment>"+c.comment+"</comment>						  <CheckinType>"+c.checkinType+"</CheckinType>						</CheckInFile>					  </soap:Body>					</soap:Envelope>";$.ajax({url:c.webSite+"_vti_bin/Lists.asmx",beforeSend:function(a){a.setRequestHeader("SOAPAction","http://schemas.microsoft.com/sharepoint/soap/CheckInFile")},type:"POST",dataType:"xml",data:d,complete:function(a){var b=$(a.responseXML).find("CheckInFileResult").text();var d={CheckInResult:b};c.complete(d)},contentType:'text/xml; charset="utf-8"'})};


////////////////////////////////////////////////////////////////////
// Tested 10/25/2012  /////////////////////////////////////////////////////
// $.intelurate.utilities.charConverter ////////////////////////////
////////////////////////////////////////////////////////////////////
$.intelurate.utilities.charConverter = ({convertTagsToCodes: function(str){var tags = [{ char: ['<', '&lt;'] },{ char: ['>', '&gt;'] } ];$.each(tags, function(i, v){	
			var re = new RegExp(v.char[0], "g");
			str = str.replace(re, v.char[1]);										
		});					
		
		return str;
	},
	displayHTML: function(str)
	{
		var chars = [{ char: ['"', '&quot;'] }, { char: ['<', '&lt;'] },{ char: ['>', '&gt;'] } ];
		
		$.each(chars, function(i, v){	
			var re = new RegExp(v.char[0], "g");
			str = str.replace(re, v.char[1]);										
		});	
		
		return $.intelurate.utilities.charConverter.addRequiredChars(str);
		
	},
	richText: function(str)
	{
		var chars = [{ char: ['"', '\''] }];
		
		$.each(chars, function(i, v){	
			var re = new RegExp(v.char[0], "g");
			str = str.replace(re, v.char[1]);										
		});	
		
		return $.intelurate.utilities.charConverter.addRequiredChars(str);	
	},
	addRequiredChars: function(str)
	{
		var chars = [ { char: ['\n', '<br/>'] }, { char: ['\r', '<br/>'] }];
		
		$.each(chars, function(i, v){	
			var re = new RegExp(v.char[0], 'g');
			str = str.replace(re, v.char[1]);										
		});	
		
		return str;
	}	
});
